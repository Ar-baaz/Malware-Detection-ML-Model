# For receiving POST request

from flask import Flask, jsonify, request

from file_checker import checkFile

# Initiating the Node
app = Flask(__name__)


@app.route('/check', methods=['POST'])
def check():
    if request.files.get('file', 0):
        f = request.files['file']
        f.save('malwares/tempFile')
    elif request.form.get('link', 0):
        l = request.form['link']
# TODO: check via link
    else:
        response = {'Invalid Response': 'Bad request'}
        return jsonify(response), 400
    
    legitimate = checkFile('malwares/tempFile')
    response = {
        'legitimate': bool(legitimate)
    }
    return jsonify(response), 200


if __name__ == '__main__':
    app.run()
